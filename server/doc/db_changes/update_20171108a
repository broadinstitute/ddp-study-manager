#oncHistory
ALTER TABLE `ddp_medical_record`
ADD COLUMN `pathology_present` VARCHAR(10) NULL DEFAULT NULL AFTER `cr_required`;

CREATE TABLE `ddp_onc_history_detail` (
  `onc_history_detail_id` int(11) NOT NULL AUTO_INCREMENT,
  `medical_record_id` int(11) NOT NULL,
  `date_px` varchar(45) DEFAULT NULL,
  `type_px` varchar(200) DEFAULT NULL,
  `location_px` varchar(200) DEFAULT NULL,
  `histology` varchar(200) DEFAULT NULL,
  `accession_number` varchar(45) DEFAULT NULL,
  `facility` varchar(200) DEFAULT NULL,
  `phone` varchar(45) DEFAULT NULL,
  `fax` varchar(45) DEFAULT NULL,
  `notes` varchar(1000) DEFAULT NULL,
  `additional_values` varchar(1000) DEFAULT NULL,
  `request` varchar(45) DEFAULT NULL,
  `fax_sent` varchar(45) DEFAULT NULL,
  `fax_confirmed` varchar(45) DEFAULT NULL,
  `tissue_received` varchar(45) DEFAULT NULL,
  `tissue_problem` tinyint(1) DEFAULT NULL,
  `tissue_problem_text` varchar(1000) DEFAULT NULL,
  `unable_obtain` tinyint(1) DEFAULT NULL,
  `gender` varchar(45) DEFAULT NULL,
  `last_changed` bigint(20) NOT NULL,
  `changed_by` varchar(45) NOT NULL,
  `deleted` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`onc_history_detail_id`),
  KEY `ddp_onc_history_medical_record_fk_idx` (`medical_record_id`),
  CONSTRAINT `onc_history_medical_record_fk` FOREIGN KEY (`medical_record_id`) REFERENCES `ddp_medical_record` (`medical_record_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `ddp_tissue` (
  `tissue_id` int(11) NOT NULL AUTO_INCREMENT,
  `onc_history_detail_id` int(11) NOT NULL,
  `notes` varchar(1000) DEFAULT NULL,
  `count_received` int(11) DEFAULT NULL,
  `tissue_type` varchar(45) DEFAULT NULL,
  `tissue_site` varchar(100) DEFAULT NULL,
  `tumor_type` varchar(45) DEFAULT NULL,
  `h_e` varchar(10) DEFAULT NULL,
  `pathology_report` varchar(10) DEFAULT NULL,
  `collaborator_sample_id` varchar(200) DEFAULT NULL,
  `block_sent` varchar(45) DEFAULT NULL,
  `scrolls_received` varchar(45) DEFAULT NULL,
  `sk_id` varchar(200) DEFAULT NULL,
  `sm_id` varchar(200) DEFAULT NULL,
  `sent_gp` varchar(45) DEFAULT NULL,
  `last_changed` bigint(20) NOT NULL,
  `changed_by` varchar(45) NOT NULL,
  `deleted` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`tissue_id`),
  KEY `ddp_tissue_onc_his_detail_fk_idx` (`onc_history_detail_id`),
  CONSTRAINT `ddp_tissue_onc_his_detail_fk` FOREIGN KEY (`onc_history_detail_id`) REFERENCES `ddp_onc_history_detail` (`onc_history_detail_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `onc_history_detail_settings` (
  `onc_history_detail_settings_id` int(11) NOT NULL AUTO_INCREMENT,
  `ddp_instance_id` int(15) NOT NULL,
  `column_name` varchar(45) NOT NULL,
  `column_display` varchar(45) NOT NULL,
  `deleted` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`onc_history_detail_settings_id`),
  KEY `ddp_instance_id_fk_idx` (`ddp_instance_id`),
  CONSTRAINT `ddp_instance_id_fk` FOREIGN KEY (`ddp_instance_id`) REFERENCES `ddp_instance` (`ddp_instance_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

#date of kit request creation
ALTER TABLE `ddp_kit_request`
ADD COLUMN `created_date` BIGINT(20) NULL DEFAULT NULL AFTER `created_by`;

ALTER TABLE `ddp_participant`
DROP FOREIGN KEY `participant_user_fk`;
ALTER TABLE `ddp_participant`
CHANGE COLUMN `assignee_id` `assignee_id_mr` INT(11) NULL DEFAULT NULL ,
ADD COLUMN `assignee_id_tissue` INT(11) NULL DEFAULT NULL AFTER `assignee_id_mr`;
ALTER TABLE `ddp_participant`
ADD INDEX `participant_user_tissue_fk_idx` (`assignee_id_tissue` ASC);
ALTER TABLE `ddp_participant`
ADD CONSTRAINT `participant_user_mr_fk`
  FOREIGN KEY (`assignee_id_mr`)
  REFERENCES `access_user` (`user_id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `participant_user_tissue_fk`
  FOREIGN KEY (`assignee_id_tissue`)
  REFERENCES `access_user` (`user_id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

ALTER TABLE `ddp_instance`
ADD COLUMN `mr_attention_flag_d` INT(11) NULL DEFAULT NULL AFTER `reminder_notification_wks`,
ADD COLUMN `tissue_attention_flag_d` INT(11) NULL DEFAULT NULL AFTER `mr_attention_flag_d`;

INSERT INTO `instance_role` (`name`) VALUES ('medical_record_reminder_notifications');
